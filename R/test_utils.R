passed <- "PASSED"
failed <- "FAILED"

#' @title Create test row
#' @param test the test class generated by one of the test functions
#' @examples
#' test <- test_na(df, cls)
#' test_row(test)
test_row <- function(test) {
  
  data.frame(df_name = test$df_name,
             col_name = test$col_name,
             test_name = test$test_name,
             test_desc = test$test_desc,
             test_result = test$test_result,
             test_message = test$test_message)
  
}

#' @title Apply tests
#' @description Applied the tests
#' @param df the dataframe to apply the test to
#' @param setup the test setup
#' @return A dataframe representing the values from a single test
#' @examples
#' df <- data.frame(x = 1:10, y = c(rep("X", 4), rep("Y", 4), rep("Z", 2)))
#' setup1 <- list(test_name = "test_range", df_name = "Test_df", col_name = "x",
#'                int = TRUE, lower_inclu = TRUE, upper_inclu = TRUE, lower = 1,
#'                upper = 10, na = FALSE)
#'
#' setup2 <- list(test_name = "test_values", df_name = "Test_df", col_name = "y",
#'                values = c("X", "Y"), na = FALSE)
#' test1 <- apply_tests(df, setup1)
#' test2 <- apply_tests(df, setup2)
#' @export
apply_tests <- function(df, setup) {
  
  test_name <- setup$test_name
  tests <- c("test_na", "test_unique", "test_values",
             "test_range", "test_bool")
  
  if (test_name %in% tests) {
  
      if (test_name == "test_na") {
        
        cls <- class_test_na(setup)
        test <- test_na(df, cls)
        
      } else if (test_name == "test_unique") {
        
        cls <- class_test_unique(setup)
        test <- test_unique(df, cls)
        
      } else if (test_name == "test_values") {
        
        cls <- class_test_values(setup)
        test <- test_values(df, cls)
        
      } else if (test_name == "test_range") {
        
        cls <- class_test_range(setup)
        test <- test_range(df, cls)
        
      }
      
      row <- test_row(test)
      
      return(row)
      
  } else {
    stop("test_name should be one of: ", paste(c("test_na", "test_unique", "test_values",
                                          "test_range", "test_bool"), collapse = ", "))
  }
}
